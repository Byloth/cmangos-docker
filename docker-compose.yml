version: "3.9"
services:
  mariadb:
    image: mariadb:10.3
    environment:
      MYSQL_ROOT_PASSWORD: root00

    networks:
      - default

    ports:
      - 3306:3306

    volumes:
      - ./database:/etc/mysql/conf.d:ro
      - ./mariadb_data:/var/lib/mysql

  mangosd:
    image: cmangos/runner:tbc
    depends_on:
      - mariadb

    environment:
      MANGOS_DBHOST: mariadb
      MANGOS_DBUSER: mangos
      MANGOS_DBPASS: mangos00

    command: mangosd
    stdin_open: true
    tty: true
    networks:
      - default
      - exposed

    ports:
      - 8085:8085

    volumes:
      - ./runner/config:/opt/mangos/conf:ro
      - ./mangosd_data/Cameras:/opt/mangos/data/Cameras:ro
      - ./mangosd_data/dbc:/opt/mangos/data/dbc:ro
      - ./mangosd_data/maps:/opt/mangos/data/maps:ro
      - ./mangosd_data/mmaps:/opt/mangos/data/mmaps:ro
      - ./mangosd_data/vmaps:/opt/mangos/data/vmaps:ro

  realmd:
    image: cmangos/runner:tbc
    depends_on:
      - mariadb

    environment:
      MANGOS_DBHOST: mariadb
      MANGOS_DBUSER: mangos
      MANGOS_DBPASS: mangos00

    command: realmd
    networks:
      - default
      - exposed

    ports:
      - 3724:3724

  phpmyadmin:
    image: phpmyadmin:5.1
    depends_on:
      - mariadb

    environment:
      PMA_HOST: mariadb
      PMA_USER: root
      PMA_PASSWORD: root00

    networks:
      - default
      - exposed

    ports:
      - 8080:80

networks:
  default:
  exposed:
    external: true
